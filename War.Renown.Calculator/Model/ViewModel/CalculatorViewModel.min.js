var Wrc;(function(n){(function(t){(function(t){var i=function(){function t(t){var i=this;this._repository=t,this.Categories=ko.observableArray(ko.utils.arrayMap(this._repository.Categories,function(t){return new n.Model.Category(t.Name)})),this.Traits=ko.observableArray(ko.utils.arrayMap(this._repository.Traits,function(t){return new n.Model.Trait(t.Category,t.Name)})),this.Levels=ko.observableArray(ko.utils.arrayMap(this._repository.Levels,function(t){return new n.Model.ValueLevel(t.Description,t.Cost,t.Trait,t.Value,!1)})),i.Spent=ko.observable(0),i.Limit=ko.observable(100)}return t.prototype.LevelsSummary=function(){var n=this;return ko.computed(function(){return"Points spent: "+n.Spent().toString()+"/"+n.Limit().toString()})},t.prototype.GetTraitsInCategory=function(n){var t=this;return t._traitsInCategory=ko.computed({read:function(){return Enumerable.From(t.Traits()).Where(function(t){return t.Category==n}).ToArray()}}),t._traitsInCategory},t.prototype.GetLevelsInTrait=function(n){var t=this;return t._LevelsInTrait=ko.computed({read:function(){return Enumerable.From(t.Levels()).Where(function(t){return t.Trait==n}).ToArray().sort(function(n,t){return t-n})}}),t._LevelsInTrait},t.prototype.ChangeLevelState=function(t,i){var r=this;return function(){var f=Enumerable.From(r.Levels()).Where(function(n){return n.Trait==t&&n.Selected==!i}),u,e;f.Count()>0&&(u=i?f.First():f.Last(),e=i?1:-1,e*(r.Spent()+parseInt(u.Cost))<=r.Limit()&&(r.Spent(r.Spent()+e*parseInt(u.Cost)),r.Levels.replace(u,new n.Model.ValueLevel(u.Description,u.Cost,u.Trait,u.Value,i))))}},t}();t.CalculatorViewModel=i})(t.ViewModel||(t.ViewModel={}));var i=t.ViewModel})(n.Model||(n.Model={}));var t=n.Model})(Wrc||(Wrc={}))